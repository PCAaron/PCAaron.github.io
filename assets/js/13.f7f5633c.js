(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{212:function(e,r,t){"use strict";t.r(r);var a=t(0),n=Object(a.a)({},(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"自建智能合约工作流"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自建智能合约工作流"}},[e._v("#")]),e._v(" 自建智能合约工作流")]),e._v(" "),t("h2",{attrs:{id:"remix局限性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#remix局限性"}},[e._v("#")]),e._v(" Remix局限性")]),e._v(" "),t("ul",[t("li",[e._v("源代码没有版本控制，实际上不存在编写一次就不用修改的代码，没有版本控制就是取乱之道；")]),e._v(" "),t("li",[e._v("智能合约只能在浏览器中运行，比如我们不能方便的把合约部署到以太坊的主网或测试网络上；")]),e._v(" "),t("li",[e._v("智能合约的测试都是手动的，手动的过程通常是不可靠的，如果有自动化的智能合约测试就好了；")])]),e._v(" "),t("h2",{attrs:{id:"truffle难点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#truffle难点"}},[e._v("#")]),e._v(" Truffle难点")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://truffleframework.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Truffle"),t("OutboundLink")],1),e._v("类似于前端的各种全家桶，帮助我们将webpack，vue等组装好。我们只需要在上面开发相关的应用逻辑即可。但是，这就带来了另一个问题，学习曲线陡，对于新入手区块链的难度就非常大了。")]),e._v(" "),t("h2",{attrs:{id:"打造工作流"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#打造工作流"}},[e._v("#")]),e._v(" 打造工作流")]),e._v(" "),t("p",[e._v("实现自己的智能合约编译、部署、测试工作流：\n"),t("img",{attrs:{src:"/images/jinjie1_1.png",alt:""}}),e._v("\n重点解决的流程（3个红色圆圈标记）：")]),e._v(" "),t("ol",[t("li",[e._v("要能够把 Solidity 源代码编译成 Bytecode 和 ABI，这个过程使用工具 "),t("a",{attrs:{href:"https://www.npmjs.com/package/solc",target:"_blank",rel:"noopener noreferrer"}},[e._v("solc"),t("OutboundLink")],1)]),e._v(" "),t("li",[e._v("要能够把编译后的 Bytecode 部署到本地测试网络（"),t("a",{attrs:{href:"https://www.npmjs.com/package/ganache-cli",target:"_blank",rel:"noopener noreferrer"}},[e._v("ganache-cli"),t("OutboundLink")],1),e._v("）、公共测试网络（"),t("a",{attrs:{href:"https://www.rinkeby.io/#stats",target:"_blank",rel:"noopener noreferrer"}},[e._v("rinkeby"),t("OutboundLink")],1),e._v("），里面要用到 "),t("a",{attrs:{href:"https://www.npmjs.com/package/web3",target:"_blank",rel:"noopener noreferrer"}},[e._v("web3.js"),t("OutboundLink")],1)]),e._v(" "),t("li",[e._v("要能够在单元测试中和部署完的智能合约实例交互，需要组合使用 web3.js 和 "),t("a",{attrs:{href:"https://www.npmjs.com/package/mocha",target:"_blank",rel:"noopener noreferrer"}},[e._v("mochajs"),t("OutboundLink")],1),e._v("；\n备注： ganache-cli 是 Truffle 框架的一部分，能够让开发者快速启动本地测试网络，而不需要大费周章的在本地运行以太坊节点；web3.js 在合约部署和自动化测试时会被大量使用。")])]),e._v(" "),t("h2",{attrs:{id:"环境准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境准备"}},[e._v("#")]),e._v(" 环境准备")]),e._v(" "),t("h3",{attrs:{id:"目录结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[e._v("#")]),e._v(" 目录结构")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("初始化package.json\n"),t("code",[e._v("npm init -y")])])]),e._v(" "),t("li",[t("p",[e._v("根目录新建.gitignore文件，内容：node_modules")])]),e._v(" "),t("li",[t("p",[e._v("目录说明\n"),t("img",{attrs:{src:"/images/jinjie1_2.png",alt:""}})])]),e._v(" "),t("li",[t("p",[e._v("安装编译工具"),t("a",{attrs:{href:"https://www.npmjs.com/package/solc",target:"_blank",rel:"noopener noreferrer"}},[e._v("solc"),t("OutboundLink")],1),e._v(" "),t("code",[e._v("yarn add solc")])])]),e._v(" "),t("li",[t("p",[e._v("编译结果保存"),t("a",{attrs:{href:"https://www.npmjs.com/package/fs-extra",target:"_blank",rel:"noopener noreferrer"}},[e._v("fs-extra"),t("OutboundLink")],1),e._v(" "),t("code",[e._v("yarn add fs-extra")])])]),e._v(" "),t("li",[t("p",[e._v("安装部署依赖"),t("a",{attrs:{href:"https://web3js.readthedocs.io/en/1.0/getting-started.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("web3..js"),t("OutboundLink")],1),e._v("，若安装不成功可尝试 "),t("code",[e._v("npm install web3@1.0.0-beta.34 --save")]),e._v(" "),t("code",[e._v("yarn add web3@1.0.0-beta.34")])])]),e._v(" "),t("li",[t("p",[e._v("为了兼容钱包，并且和Infura节点通讯的web3.js插件，安装"),t("a",{attrs:{href:"https://www.npmjs.com/package/truffle-hdwallet-provider",target:"_blank",rel:"noopener noreferrer"}},[e._v("truffle-hdwallet-provider"),t("OutboundLink")],1),e._v("作为provider，该插件支持通过助记词去管理账户：\n"),t("code",[e._v("yarn add truffle-hdwallet-provider@0.03")]),e._v("\n备注：若安装不成功，则可能需要使用管理员身份执行命令``npm install --global --production windows-build-tools`去安装工具")])]),e._v(" "),t("li",[t("p",[e._v("使用 mocha + web3.js + ganache 编写合约测试，安装依赖"),t("a",{attrs:{href:"https://www.npmjs.com/package/ganache-cli",target:"_blank",rel:"noopener noreferrer"}},[e._v("ganache-cli"),t("OutboundLink")],1),e._v("、mocha\n"),t("code",[e._v("yarn add ganache-cli mocha -D")])])])]),e._v(" "),t("h2",{attrs:{id:"star-or-打赏"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#star-or-打赏"}},[e._v("#")]),e._v(" star or 打赏")]),e._v(" "),t("blockquote",[t("p",[e._v("Imtoken地址: 0x4a6Ac825993737a4f7F1ed12fcAc1b27e247c55A")])]),e._v(" "),t("blockquote",[t("p",[e._v("打赏码\n"),t("img",{attrs:{src:"/wxzz.jpg",alt:"赞助支持"}})])])])}),[],!1,null,null,null);r.default=n.exports}}]);