<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack的基本用法：常用配置 | Web全栈技术笔记</title>
    <meta name="description" content="Web技术笔记，记录前端的进阶之路">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.d20cb8b9.css" as="style"><link rel="preload" href="/assets/js/app.2c921ca0.js" as="script"><link rel="preload" href="/assets/js/2.29093f4e.js" as="script"><link rel="preload" href="/assets/js/43.b51c1b2e.js" as="script"><link rel="prefetch" href="/assets/js/10.e7261647.js"><link rel="prefetch" href="/assets/js/11.3acb9245.js"><link rel="prefetch" href="/assets/js/12.30fa2830.js"><link rel="prefetch" href="/assets/js/13.f7f5633c.js"><link rel="prefetch" href="/assets/js/14.077d15bd.js"><link rel="prefetch" href="/assets/js/15.ca4c6dcf.js"><link rel="prefetch" href="/assets/js/16.33c76806.js"><link rel="prefetch" href="/assets/js/17.c1d108fb.js"><link rel="prefetch" href="/assets/js/18.f2c74917.js"><link rel="prefetch" href="/assets/js/19.4d0677d6.js"><link rel="prefetch" href="/assets/js/20.05a49d49.js"><link rel="prefetch" href="/assets/js/21.303ca718.js"><link rel="prefetch" href="/assets/js/22.dd8c450d.js"><link rel="prefetch" href="/assets/js/23.c436f815.js"><link rel="prefetch" href="/assets/js/24.5817cae1.js"><link rel="prefetch" href="/assets/js/25.7640084e.js"><link rel="prefetch" href="/assets/js/26.6981ceda.js"><link rel="prefetch" href="/assets/js/27.d96b5401.js"><link rel="prefetch" href="/assets/js/28.7e5507ca.js"><link rel="prefetch" href="/assets/js/29.0486ec9e.js"><link rel="prefetch" href="/assets/js/3.5ee6df4b.js"><link rel="prefetch" href="/assets/js/30.0705fdc2.js"><link rel="prefetch" href="/assets/js/31.3e20c412.js"><link rel="prefetch" href="/assets/js/32.40154bdb.js"><link rel="prefetch" href="/assets/js/33.54042f7d.js"><link rel="prefetch" href="/assets/js/34.992a68b5.js"><link rel="prefetch" href="/assets/js/35.fe5d31f8.js"><link rel="prefetch" href="/assets/js/36.20985163.js"><link rel="prefetch" href="/assets/js/37.7e0e1be1.js"><link rel="prefetch" href="/assets/js/38.c81dfd87.js"><link rel="prefetch" href="/assets/js/39.799324c8.js"><link rel="prefetch" href="/assets/js/4.505f2474.js"><link rel="prefetch" href="/assets/js/40.4a8ca097.js"><link rel="prefetch" href="/assets/js/41.3bdce235.js"><link rel="prefetch" href="/assets/js/42.13fe7b3a.js"><link rel="prefetch" href="/assets/js/44.408a421f.js"><link rel="prefetch" href="/assets/js/45.63e44fa3.js"><link rel="prefetch" href="/assets/js/46.409b4b6a.js"><link rel="prefetch" href="/assets/js/47.e253242d.js"><link rel="prefetch" href="/assets/js/48.ba57127f.js"><link rel="prefetch" href="/assets/js/49.7637631e.js"><link rel="prefetch" href="/assets/js/5.5326fad8.js"><link rel="prefetch" href="/assets/js/50.5c4dae5f.js"><link rel="prefetch" href="/assets/js/51.5ced2ccf.js"><link rel="prefetch" href="/assets/js/52.0447cb17.js"><link rel="prefetch" href="/assets/js/53.bb22200a.js"><link rel="prefetch" href="/assets/js/54.cbb62dbb.js"><link rel="prefetch" href="/assets/js/55.951cd720.js"><link rel="prefetch" href="/assets/js/56.3026c904.js"><link rel="prefetch" href="/assets/js/57.925dacf9.js"><link rel="prefetch" href="/assets/js/58.32a50715.js"><link rel="prefetch" href="/assets/js/59.f1f9cb40.js"><link rel="prefetch" href="/assets/js/6.9c6dd834.js"><link rel="prefetch" href="/assets/js/60.be19c9ef.js"><link rel="prefetch" href="/assets/js/61.c84c312a.js"><link rel="prefetch" href="/assets/js/62.b2e36c2d.js"><link rel="prefetch" href="/assets/js/7.a22cca04.js"><link rel="prefetch" href="/assets/js/8.34ea0bd8.js"><link rel="prefetch" href="/assets/js/9.224ad97b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d20cb8b9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="Web全栈技术笔记" class="logo"> <span class="site-name can-hide">Web全栈技术笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fe/vue/" class="nav-link">Vue.js实战</a></li><li class="dropdown-item"><!----> <a href="/pages/fe/webpack/" class="nav-link router-link-active">玩转webpack4.0</a></li><li class="dropdown-item"><!----> <a href="/pages/fe/chrome/" class="nav-link">浏览器工作原理与实战</a></li><li class="dropdown-item"><!----> <a href="/pages/fe/block/introduce.html" class="nav-link">区块链开发入门</a></li><li class="dropdown-item"><!----> <a href="/pages/fe/git/" class="nav-link">Git命令大全</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/PCAaron/PCAaron.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.cnblogs.com/aaron-pan/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fe/vue/" class="nav-link">Vue.js实战</a></li><li class="dropdown-item"><!----> <a href="/pages/fe/webpack/" class="nav-link router-link-active">玩转webpack4.0</a></li><li class="dropdown-item"><!----> <a href="/pages/fe/chrome/" class="nav-link">浏览器工作原理与实战</a></li><li class="dropdown-item"><!----> <a href="/pages/fe/block/introduce.html" class="nav-link">区块链开发入门</a></li><li class="dropdown-item"><!----> <a href="/pages/fe/git/" class="nav-link">Git命令大全</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/PCAaron/PCAaron.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.cnblogs.com/aaron-pan/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack导读</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/fe/webpack/" class="sidebar-link">Webpack导读</a></li><li><a href="/pages/fe/webpack/history.html" class="sidebar-link">webpack与构建发展史</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>webpack基础篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/fe/webpack/basic.html" class="sidebar-link">webpack的基本用法：核心概念</a></li><li><a href="/pages/fe/webpack/basicUsage.html" class="active sidebar-link">webpack的基本用法：常用配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/fe/webpack/basicUsage.html#解析es6" class="sidebar-link">解析ES6</a></li><li class="sidebar-sub-header"><a href="/pages/fe/webpack/basicUsage.html#解析react-jsx" class="sidebar-link">解析React:JSX</a></li><li class="sidebar-sub-header"><a href="/pages/fe/webpack/basicUsage.html#解析css和less" class="sidebar-link">解析CSS和Less</a></li><li class="sidebar-sub-header"><a href="/pages/fe/webpack/basicUsage.html#解析图片和字体" class="sidebar-link">解析图片和字体</a></li><li class="sidebar-sub-header"><a href="/pages/fe/webpack/basicUsage.html#文件监听-watch" class="sidebar-link">文件监听:watch</a></li><li class="sidebar-sub-header"><a href="/pages/fe/webpack/basicUsage.html#热更新：webpack-dev-server" class="sidebar-link">热更新：webpack-dev-server</a></li><li class="sidebar-sub-header"><a href="/pages/fe/webpack/basicUsage.html#文件指纹" class="sidebar-link">文件指纹</a></li><li class="sidebar-sub-header"><a href="/pages/fe/webpack/basicUsage.html#代码压缩" class="sidebar-link">代码压缩</a></li><li class="sidebar-sub-header"><a href="/pages/fe/webpack/basicUsage.html#推荐阅读" class="sidebar-link">推荐阅读</a></li></ul></li><li><a href="/pages/fe/webpack/improve.html" class="sidebar-link">webpack的进阶用法（一）</a></li><li><a href="/pages/fe/webpack/improveMore.html" class="sidebar-link">webpack的进阶用法（二）</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack进阶篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/fe/webpack/config.html" class="sidebar-link">可维护的webpack构建配置</a></li><li><a href="/pages/fe/webpack/optimize.html" class="sidebar-link">webpack构建速度及体积优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack原理篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/fe/webpack/principle.html" class="sidebar-link">运行webpack发生了什么？</a></li><li><a href="/pages/fe/webpack/nature.html" class="sidebar-link">webpack插件机制</a></li><li><a href="/pages/fe/webpack/flow.html" class="sidebar-link">webpack编译流程分析</a></li><li><a href="/pages/fe/webpack/webpack.html" class="sidebar-link">迷你webpack的实现</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>编写loader和plugin</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/fe/webpack/loader.html" class="sidebar-link">编写一个loader</a></li><li><a href="/pages/fe/webpack/plugin.html" class="sidebar-link">编写一个plugin</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack的基本用法：常用配置"><a href="#webpack的基本用法：常用配置" class="header-anchor">#</a> webpack的基本用法：常用配置</h1> <h2 id="解析es6"><a href="#解析es6" class="header-anchor">#</a> 解析ES6</h2> <h3 id="了解babel"><a href="#了解babel" class="header-anchor">#</a> 了解Babel</h3> <p>Babel是一个JavaScript编译器，可以实现将ES6+转换成浏览器能够
识别的代码。</p> <p>Babel在执行编译时，可以依赖.babelrc文件，当设置依赖文件时，
会从项目的根目录下读取**.babelrc<strong>的配置项，.babelrc配置文件
主要是对</strong>预设(presets)<strong>和</strong>插件(plugins)**进行配置。</p> <p>其中，presets可以标识需要转换的源码使用了哪些新特性，
可以理解为一系列plugins的集合，例如babel-preset-es2015，可以
将es6转换为es5；而plugins则指示babel如何对代码进行转换，
例如plugin-transform-arrow-functions可将ES6语法转换为
ES5。</p> <h3 id="解析es6-2"><a href="#解析es6-2" class="header-anchor">#</a> 解析ES6</h3> <p>1、安装依赖</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i @babel<span class="token operator">/</span>core @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env babel<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>2、配置webpack.config.js设置loader</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/.js$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>3、根目录创建.babelrc，并配置preset-env对ES6+语法特性进行转换</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;presets&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@babel/preset-env&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="解析react-jsx"><a href="#解析react-jsx" class="header-anchor">#</a> 解析React:JSX</h2> <p>1、安装react及@babel/preset-react</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i react react<span class="token operator">-</span>dom @babel<span class="token operator">/</span>preset<span class="token operator">-</span>react <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>2、配置解析React的presets</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;presets&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@babel/preset-react&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="解析css和less"><a href="#解析css和less" class="header-anchor">#</a> 解析CSS和Less</h2> <p>css-loader：用于加载.css文件并转换成commonjs对象。<br>
style-loader：将样式通过style标签插入到head中。</p> <p>1、安装依赖css-loader和style-loader</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i style<span class="token operator">-</span>loader css<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>2、webpack配置项添加loader配置，其中由于loader的执行顺序是从右
向左执行，所以会先进行css的样式解析后执行style标签的插入。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
   test<span class="token punctuation">:</span><span class="token regex">/.css$/</span><span class="token punctuation">,</span>
   use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
      <span class="token string">'css-loader'</span>
   <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3、less-loader，将less转换成css。安装less-loader依赖并添加webpack配置</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i less less<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span><span class="token regex">/.less$/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
         <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
         <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
         <span class="token string">'less-loader'</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="解析图片和字体"><a href="#解析图片和字体" class="header-anchor">#</a> 解析图片和字体</h2> <h3 id="file-loader"><a href="#file-loader" class="header-anchor">#</a> file-loader</h3> <p>file-loader:用于处理文件及字体。</p> <p>按照file-loader依赖并配置</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i file<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
   test<span class="token punctuation">:</span> <span class="token regex">/\.(png|svg|jpg|jpeg|gif)$/</span><span class="token punctuation">,</span>
   use<span class="token punctuation">:</span> <span class="token string">'file-loader'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    test<span class="token punctuation">:</span><span class="token regex">/\.(woff|woff2|eot|ttf|otf|svg)/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span><span class="token string">'file-loader'</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="url-loader"><a href="#url-loader" class="header-anchor">#</a> url-loader</h3> <p>url-loader也可以处理文件及字体，对比file-loader的优势就是可以通过设置配置，
设置小资源自动转换为base64。</p> <p>安装url-loader依赖并配置webpack。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
     test<span class="token punctuation">:</span> <span class="token regex">/\.(png|svg|jpg|jpeg|gif)$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
           <span class="token punctuation">{</span>
               loader<span class="token punctuation">:</span><span class="token string">'url-loader'</span><span class="token punctuation">,</span>
               options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                   limit<span class="token punctuation">:</span><span class="token number">10240</span>
               <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="文件监听-watch"><a href="#文件监听-watch" class="header-anchor">#</a> 文件监听:watch</h2> <p>通过监听源码的变化，自动构建出新的输出文件。</p> <p>可通过webpack添加配置或者CLI添加的方式开启监听模式，该方式源码变化时需要每次手动刷新浏览器：</p> <p>1、webpack配置设置</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
    watch<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2、CLI添加参数:-- watch。</p> <p>除了通过<strong>watch</strong>参数的配置方式开启监听，亦可通过定制watch模式选项的形式<strong>watchOptions</strong>来
定制监听配置。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
    watch<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 只有开启了监听模式，才有效</span>
    watchOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        ignored<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span> <span class="token comment">//默认为空，设置不监听的文件或文件夹</span>
        aggregateTimeout<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token comment">// 默认300ms，监听变化后需要等待的执行时间</span>
        poll<span class="token punctuation">:</span><span class="token number">1000</span>   <span class="token comment">// 默认1000ms，通过轮询的方式询问系统指定文件是否发生变化</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="热更新：webpack-dev-server"><a href="#热更新：webpack-dev-server" class="header-anchor">#</a> 热更新：webpack-dev-server</h2> <h3 id="热更新基本原理"><a href="#热更新基本原理" class="header-anchor">#</a> 热更新基本原理</h3> <p>热更新大概流程：<br> <img src="/webpack/basicDev.jpg" alt="webpack-dev-server热更新流程"></p> <p>webpack Compiler，将JavaScript编译成输出的bundle文件。<br>
HMR Server，将热更新的文件输出到HMR Runtime。<br>
Bundle Server，通过提供服务器的形式，提供浏览器对文件的访问。<br>
HMR Runtime，开发打包阶段时，将构建输出文件注入到浏览器，更新文件的变化。</p> <p>当启动webpack-dev-server阶段时，将源码在文件系统进行编译，通过webpack Compiler编译器
打包，并将编译好的文件提交给Bundle Server服务器；Bundle Server即可以服务器的
方式供浏览器访问。</p> <p>当监听到源码发生变化时，经过webpack Compiler的编译后提交给
HMR Server，一般通过websocket实现监听源码的变化，并通过json数据的格式通知HMR Runtime，HMR Runtime
对bundle进行改变并刷新浏览器。</p> <h3 id="热更新配置"><a href="#热更新配置" class="header-anchor">#</a> 热更新配置</h3> <p>相比于watch不能自动刷新浏览器，webpack-dev-server的优势就明显了。
webpack-dev-server构建的内容会存放在内存中，所以构建速度更快，
并且可自动的实现浏览器的自动识别并作出变化。其中，webpack-dev-server
需要配合webpack内置的HotModuleReplacementPlugin插件一起使用。</p> <p>1、安装依赖webpack-dev-server并配置启动项</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// package.json</span>
<span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;dev&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;webpack-dev-server --open&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2、配置webpack,其中webpack-dev-server一般在开发环境中使用，所以需
设置mode模式为development。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
     <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        contentBase<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// 监听dist文件夹下内容</span>
        hot<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token comment">//启动热更新</span>
<span class="token punctuation">}</span>
</code></pre></div><p>更多配置项可参考：<a href="https://www.webpackjs.com/configuration/dev-server/" target="_blank" rel="noopener noreferrer">https://www.webpackjs.com/configuration/dev-server/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="文件指纹"><a href="#文件指纹" class="header-anchor">#</a> 文件指纹</h2> <p>hash：整个项目的构建相关，当有文件修改，整个项目构建的hash值就会更新。<br>
chunkhash：和webpack打包的chunk相关，不同的entry会生成不同的chunkhash，一般用于js的打包。<br>
contenthash：根据文件内容来定义hash，文件内容不变，contenthash不变。例如css的打包，由于
修改js或html文件，但是没有修改引入的css样式时，文件不需要生成新的哈希值，所以可适用于css的打包。</p> <p>备注，文件指纹不能和热更新一起使用。</p> <h3 id="js文件指纹设置-chunkhash"><a href="#js文件指纹设置-chunkhash" class="header-anchor">#</a> JS文件指纹设置:chunkhash</h3> <p>webpack.dev.js</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
     entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
           index<span class="token punctuation">:</span> <span class="token string">'./src/demo.js'</span><span class="token punctuation">,</span>
           search<span class="token punctuation">:</span> <span class="token string">'./src/search.js'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            filename<span class="token punctuation">:</span> <span class="token string">'[name][chunkhash:8].js'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="css文件指纹：contenthash"><a href="#css文件指纹：contenthash" class="header-anchor">#</a> CSS文件指纹：contenthash</h3> <p>由于上面方式通过style标签将CSS插入到head中并没有生成单独的CSS文件，我们可以
通过min-css-extract-plugin插件将CSS提取成单独的CSS文件，并添加文件指纹。</p> <p>1、安装依赖mini-css-extract-plugin</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i mini<span class="token operator">-</span>css<span class="token operator">-</span>extract<span class="token operator">-</span>plugin <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>2、配置CSS文件指纹</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span><span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
                    <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
     plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
           filename<span class="token punctuation">:</span> <span class="token string">'[name][contenthash:8].css'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="图片文件指纹设置：hash"><a href="#图片文件指纹设置：hash" class="header-anchor">#</a> 图片文件指纹设置：hash</h3> <p>其中，hash对应的是文件内容的哈希值，默认为md5生成，不同于前面所说的hash值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">:</span><span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                 test<span class="token punctuation">:</span> <span class="token regex">/\.(png|svg|jpg|jpeg|gif)$/</span><span class="token punctuation">,</span>
                 use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                     loader<span class="token punctuation">:</span><span class="token string">'file-loader'</span><span class="token punctuation">,</span>
                     options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                         name<span class="token punctuation">:</span> <span class="token string">'img/[name][hash:8].[ext]'</span>
                     <span class="token punctuation">}</span>
                 <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="代码压缩"><a href="#代码压缩" class="header-anchor">#</a> 代码压缩</h2> <p>其中js压缩，webpack4.x版本已经内置了<strong>uglifyjs-webpack-plugin</strong>实现压缩。</p> <h3 id="css-文件压缩：optimize-css-assets-webpack-plugin"><a href="#css-文件压缩：optimize-css-assets-webpack-plugin" class="header-anchor">#</a> CSS 文件压缩：optimize-css-assets-webpack-plugin</h3> <p>1、安装optimize-css-assets-webpack-plugin和预处理器cssnano</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i optimize<span class="token operator">-</span>css<span class="token operator">-</span>assets<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin cssnano <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>2、配置webpack</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> OptimizeCssAssetsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-assets-webpack-plugin'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
         <span class="token keyword">new</span> <span class="token class-name">OptimizeCssAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
             assetNameRegExp<span class="token punctuation">:</span> <span class="token regex">/\.css$/g</span><span class="token punctuation">,</span>
             cssProcessor<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="html文件压缩：html-webpack-plugin"><a href="#html文件压缩：html-webpack-plugin" class="header-anchor">#</a> html文件压缩：html-webpack-plugin</h3> <p>1、安装html-webpack-plugin插件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm i html<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>2、配置webpack</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
         <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
             template<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src/search.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 使用模板</span>
             filename<span class="token punctuation">:</span> <span class="token string">'search.html'</span><span class="token punctuation">,</span>    <span class="token comment">//  打包后的文件名</span>
             chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'search'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 打包后需要使用的chunk(文件)</span>
             inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 默认注入所有静态资源</span>
             minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                  html5<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
                  collapsableWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                  preserveLineBreaks<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                  minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                  minifyJS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                  removeComments<span class="token punctuation">:</span> <span class="token boolean">false</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对应demo代码可查看地址：<a href="https://github.com/PCAaron/blogCode/tree/master/webpack/webpack-basic" target="_blank" rel="noopener noreferrer">https://github.com/PCAaron/blogCode/tree/master/webpack/webpack-basic<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="推荐阅读"><a href="#推荐阅读" class="header-anchor">#</a> 推荐阅读</h2> <p>Babel:<a href="https://babeljs.io/docs/en/" target="_blank" rel="noopener noreferrer">https://babeljs.io/docs/en/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>webpack-dev-middleware:<a href="https://github.com/webpack/webpack-dev-middleware" target="_blank" rel="noopener noreferrer">https://github.com/webpack/webpack-dev-middleware<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>webpack热更新原理:<a href="https://segmentfault.com/a/1190000020310371" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/1190000020310371<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pages/fe/webpack/basic.html" class="prev">webpack的基本用法：核心概念</a></span> <span class="next"><a href="/pages/fe/webpack/improve.html">webpack的进阶用法（一）</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2c921ca0.js" defer></script><script src="/assets/js/2.29093f4e.js" defer></script><script src="/assets/js/43.b51c1b2e.js" defer></script>
  </body>
</html>
